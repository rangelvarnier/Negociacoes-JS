{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoService","NegociacoesView","MensagemView","Bind","ListaNegociacoes","Mensagem","DateHelper","Negociacao","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_service","_init","lista","then","negociacoes","forEach","adicionar","negociacao","catch","texto","erro","setInterval","importarNegociacoes","event","preventDefault","_criarNegociacao","cadastrar","mensagem","_limparFormulario","importa","apaga","esvasiar","textoParaDate","value","parseInt","parseFloat","focus"],"mappings":";;;;;;;;;;;;;;;AAAQA,6B,8BAAAA,iB;;AACAC,2B,yBAAAA,e;;AACAC,wB,sBAAAA,Y;;AACAC,gB,gBAAAA,I;;AACAC,4B,2BAAAA,gB;;AACAC,oB,mBAAAA,Q;;AACAC,sB,sBAAAA,U;;AACAC,sB,qBAAAA,U;;;;;;;;;;;;;;;;;;;;;4CAEKC,oB;AAET,gDAAc;AAAA;;AACV,wBAAIC,IAAIC,SAASC,aAAT,CAAuBC,IAAvB,CAA4BF,QAA5B,CAAR;;AAEA,yBAAKG,UAAL,GAAkBJ,EAAE,OAAF,CAAlB;AACA,yBAAKK,gBAAL,GAAwBL,EAAE,aAAF,CAAxB;AACA,yBAAKM,WAAL,GAAmBN,EAAE,QAAF,CAAnB;;AAEA,yBAAKO,iBAAL,GAAyB,IAAIb,IAAJ,CAAS,IAAIC,gBAAJ,EAAT,EACrB,IAAIH,eAAJ,CAAoBQ,EAAE,kBAAF,CAApB,CADqB,EACuB,WADvB,EACoC,UADpC,CAAzB;;AAGA,yBAAKQ,SAAL,GAAiB,IAAId,IAAJ,CAAS,IAAIE,QAAJ,EAAT,EACb,IAAIH,YAAJ,CAAiBO,EAAE,eAAF,CAAjB,CADa,EACyB,OADzB,CAAjB;AAEA,yBAAKS,QAAL,GAAgB,IAAIlB,iBAAJ,EAAhB;AACA,yBAAKmB,KAAL;AACH;;;;4CAEM;AAAA;;AACH,6BAAKD,QAAL,CACKE,KADL,GAEKC,IAFL,CAEU;AAAA,mCACFC,YAAYC,OAAZ,CAAoB;AAAA,uCAChB,MAAKP,iBAAL,CAAuBQ,SAAvB,CAAiCC,UAAjC,CADgB;AAAA,6BAApB,CADE;AAAA,yBAFV,EAKaC,KALb,CAKmB;AAAA,mCAAQ,MAAKT,SAAL,CAAeU,KAAf,GAAuBC,IAA/B;AAAA,yBALnB;;AAOAC,oCAAY,YAAM;AACd,kCAAKC,mBAAL;AACH,yBAFD,EAEG,IAFH;AAGH;;;8CAESC,K,EAAO;AAAA;;AACbA,8BAAMC,cAAN;;AAEA,4BAAIP,aAAa,KAAKQ,gBAAL,EAAjB;AACA,6BAAKf,QAAL,CACKgB,SADL,CACeT,UADf,EAEKJ,IAFL,CAEU,oBAAY;AACd,mCAAKL,iBAAL,CAAuBQ,SAAvB,CAAiCC,UAAjC;AACA,mCAAKR,SAAL,CAAeU,KAAf,GAAuBQ,QAAvB;AACA,mCAAKC,iBAAL;AACH,yBANL,EAMOV,KANP,CAMa;AAAA,mCAAQ,OAAKT,SAAL,CAAeU,KAAf,GAAuBC,IAA/B;AAAA,yBANb;AAOH;;;0DAEqB;AAAA;;AAClB,6BAAKV,QAAL,CACKmB,OADL,CACa,KAAKrB,iBAAL,CAAuBM,WADpC,EAEKD,IAFL,CAEU;AAAA,mCAAeC,YAAYC,OAAZ,CAAoB,sBAAc;AACnD,uCAAKP,iBAAL,CAAuBQ,SAAvB,CAAiCC,UAAjC;AACA,uCAAKR,SAAL,CAAeU,KAAf,GAAuB,mCAAvB;AACH,6BAHoB,CAAf;AAAA,yBAFV,EAMKD,KANL,CAMW;AAAA,mCAAQ,OAAKT,SAAL,CAAeU,KAAf,GAAuBC,IAA/B;AAAA,yBANX;AAOH;;;6CAEQ;AAAA;;AACL,6BAAKV,QAAL,CACKoB,KADL,GAEKjB,IAFL,CAEU,oBAAY;AACd,mCAAKJ,SAAL,CAAeU,KAAf,GAAuBQ,QAAvB;AACA,mCAAKnB,iBAAL,CAAuBuB,QAAvB;AACH,yBALL;AAMH;;;uDAEkB;AACf,+BAAO,IAAIhC,UAAJ,CACHD,WAAWkC,aAAX,CAAyB,KAAK3B,UAAL,CAAgB4B,KAAzC,CADG,EAEHC,SAAS,KAAK5B,gBAAL,CAAsB2B,KAA/B,CAFG,EAGHE,WAAW,KAAK5B,WAAL,CAAiB0B,KAA5B,CAHG,CAAP;AAKH;;;wDAEmB;AAChB,6BAAK5B,UAAL,CAAgB4B,KAAhB,GAAwB,EAAxB;AACA,6BAAK3B,gBAAL,CAAsB2B,KAAtB,GAA8B,CAA9B;AACA,6BAAK1B,WAAL,CAAiB0B,KAAjB,GAAyB,GAAzB;AACA,6BAAK5B,UAAL,CAAgB+B,KAAhB;AACH","file":"NegociacaoController.js","sourcesContent":["import {NegociacaoService} from '../services/NegociacaoService';\nimport {NegociacoesView} from '../views/NegociacoesView';\nimport {MensagemView} from '../views/MensagemView';\nimport {Bind} from '../helpers/Bind';\nimport {ListaNegociacoes} from '../models/ListaNegociacoes';\nimport {Mensagem} from '../models/Mensagem';\nimport {DateHelper} from '../helpers/DateHelper';\nimport {Negociacao} from '../models/Negociacao';\n\nexport class NegociacaoController {\n\n    constructor() {\n        let $ = document.querySelector.bind(document);\n\n        this._inputData = $(\"#data\");\n        this._inputQuantidade = $(\"#quantidade\");\n        this._inputValor = $(\"#valor\");\n\n        this._listaNegociacoes = new Bind(new ListaNegociacoes(),\n            new NegociacoesView($(\"#negociacoesView\")), 'adicionar', 'esvasiar');\n\n        this._mensagem = new Bind(new Mensagem(),\n            new MensagemView($(\"#mensagemView\")), 'texto');\n        this._service = new NegociacaoService();\n        this._init();\n    }\n\n    _init(){\n        this._service\n            .lista()\n            .then(negociacoes =>\n                negociacoes.forEach(negociacao =>\n                    this._listaNegociacoes.adicionar(negociacao)))\n                    .catch(erro => this._mensagem.texto = erro);\n\n        setInterval(() => {\n            this.importarNegociacoes();\n        }, 3000);\n    }\n\n    adicionar(event) {\n        event.preventDefault();\n\n        let negociacao = this._criarNegociacao();\n        this._service\n            .cadastrar(negociacao)\n            .then(mensagem => {\n                this._listaNegociacoes.adicionar(negociacao);\n                this._mensagem.texto = mensagem;\n                this._limparFormulario();\n            }).catch(erro => this._mensagem.texto = erro);\n    }\n\n    importarNegociacoes() {\n        this._service\n            .importa(this._listaNegociacoes.negociacoes)\n            .then(negociacoes => negociacoes.forEach(negociacao => {\n                this._listaNegociacoes.adicionar(negociacao);\n                this._mensagem.texto = 'Negociações do período importadas'\n            }))\n            .catch(erro => this._mensagem.texto = erro);\n    }\n\n    apagar() {\n        this._service\n            .apaga()\n            .then(mensagem => {\n                this._mensagem.texto = mensagem;\n                this._listaNegociacoes.esvasiar();\n            });\n    }\n\n    _criarNegociacao() {\n        return new Negociacao(\n            DateHelper.textoParaDate(this._inputData.value),\n            parseInt(this._inputQuantidade.value),\n            parseFloat(this._inputValor.value)\n        )\n    }\n\n    _limparFormulario() {\n        this._inputData.value = \"\";\n        this._inputQuantidade.value = 1;\n        this._inputValor.value = 0.0;\n        this._inputData.focus();\n    }\n}\n"]}